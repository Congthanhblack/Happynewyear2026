<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>G·ª≠i b√© Chinh üíù - Happy New Year</title>
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Pacifico&display=swap" rel="stylesheet">

<style>
    body {
        margin: 0;
        background: radial-gradient(circle at center, #1a0505 0%, #000000 100%);
        overflow: hidden;
        font-family: 'Dancing Script', cursive;
        touch-action: manipulation; /* T·ªëi ∆∞u c·∫£m ·ª©ng */
    }

    /* Container ch√≠nh */
    #ui-layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none; /* ƒê·ªÉ click xuy√™n qua canvas */
        z-index: 10;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    /* N√∫t b·∫•m ban ƒë·∫ßu */
    #startBtn {
        pointer-events: auto;
        padding: 15px 35px;
        font-size: 22px;
        background: linear-gradient(45deg, #ff0055, #ff99cc);
        border: 2px solid #fff;
        border-radius: 50px;
        color: white;
        cursor: pointer;
        font-family: 'Pacifico', cursive;
        box-shadow: 0 0 20px rgba(255, 0, 85, 0.5);
        transition: all 0.3s;
        animation: pulse 2s infinite;
    }

    #startBtn:active {
        transform: scale(0.95);
    }

    /* L·ªùi ch√∫c ch√≠nh gi·ªØa */
    .message-box {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
        opacity: 0;
        transition: opacity 2s ease-in-out;
        width: 90%;
    }

    .main-text {
        font-size: clamp(30px, 8vw, 60px); /* T·ª± ch·ªânh size theo m√†n h√¨nh */
        color: #ff99cc;
        text-shadow: 0 0 15px rgba(255, 0, 100, 0.8);
        margin-bottom: 10px;
    }

    .sub-text {
        font-size: clamp(18px, 5vw, 28px);
        color: #fff;
        font-weight: 300;
    }

    /* C√¢u ƒë·ªëi hai b√™n */
    .couplet {
        position: absolute;
        top: 15%;
        width: 50px;
        padding: 20px 10px;
        background: #b30000;
        color: #ffeb3b; /* M√†u v√†ng kim */
        border: 2px solid #ffeb3b;
        border-radius: 10px;
        font-size: clamp(16px, 4vw, 24px);
        text-align: center;
        writing-mode: vertical-rl; /* Vi·∫øt d·ªçc */
        text-orientation: upright;
        box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
        opacity: 0;
        transform: translateY(-50px);
        transition: all 1.5s ease-out;
    }

    .couplet.left { left: 20px; }
    .couplet.right { right: 20px; }

    /* Hi·ªáu ·ª©ng hi·ªÉn th·ªã */
    .visible {
        opacity: 1 !important;
        transform: translateY(0) !important;
    }

    canvas {
        display: block;
    }

    @keyframes pulse {
        0% { transform: scale(1); box-shadow: 0 0 20px rgba(255, 0, 85, 0.5); }
        50% { transform: scale(1.05); box-shadow: 0 0 40px rgba(255, 0, 85, 0.8); }
        100% { transform: scale(1); box-shadow: 0 0 20px rgba(255, 0, 85, 0.5); }
    }
</style>
</head>
<body>

<canvas id="canvas"></canvas>

<div id="ui-layer">
    <button id="startBtn" onclick="startShow()">üíå M·ªü qu√† T·∫øt nh√©!</button>
    
    <div class="couplet left" id="coupLeft">
        T·∫øt n√†y v·∫´n gi·ªëng t·∫øt x∆∞a
    </div>
    <div class="couplet right" id="coupRight">
        V·∫´n ch∆∞a c√≥ v·ª£ v·∫´n ∆∞a Chinh nhi·ªÅu
    </div>

    <div class="message-box" id="msgBox">
        <div class="main-text">Y√™u B√© Chinh ‚ù§Ô∏è</div>
        <div class="sub-text">NƒÉm m·ªõi vui v·∫ª, m√£i b√™n anh nh√©!</div>
    </div>
</div>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let width, height;
let particles = [];
let flowers = []; // C√°nh hoa r∆°i
let isHeartFormed = false;
let heartScale = 15; // T·ªâ l·ªá tim

// C·∫•u h√¨nh s·ªë l∆∞·ª£ng
const PARTICLE_COUNT = 400; // S·ªë l∆∞·ª£ng tim nh·ªè
const FLOWER_COUNT = 30;    // S·ªë l∆∞·ª£ng c√°nh hoa ƒë√†o/mai

function resize() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
    // ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc tim d·ª±a tr√™n m√†n h√¨nh
    heartScale = Math.min(width, height) / 45;
}
resize();
window.addEventListener('resize', resize);

// --- H√ÄM TO√ÅN H·ªåC TR√ÅI TIM ---
function getHeartPoint(t) {
    // C√¥ng th·ª©c tr√°i tim kinh ƒëi·ªÉn
    const x = 16 * Math.pow(Math.sin(t), 3);
    const y = -(13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t));
    return { x, y };
}

// --- CLASS PARTICLES (Tr√°i tim nh·ªè) ---
class Particle {
    constructor(isHeartMode = false) {
        this.reset();
        if (isHeartMode) this.setHeartTarget();
    }

    reset() {
        this.x = Math.random() * width;
        this.y = Math.random() * height;
        this.size = Math.random() * 2 + 1; // K√≠ch th∆∞·ªõc ng·∫´u nhi√™n
        this.opacity = Math.random() * 0.5 + 0.3;
        
        // M√†u s·∫Øc: ch·ªß y·∫øu l√† h·ªìng v√† ƒë·ªè
        const colors = ["#ff0055", "#ff4d88", "#ff99cc", "#ff3366"];
        this.color = colors[Math.floor(Math.random() * colors.length)];
        
        // Ch·∫ø ƒë·ªô bay t·ª± do
        this.vx = (Math.random() - 0.5) * 1; 
        this.vy = (Math.random() - 0.5) * 1;
        
        this.targetX = null;
        this.targetY = null;
        this.friction = 0.05; // ƒê·ªô tr∆∞·ª£t khi v·ªÅ v·ªã tr√≠
    }

    setHeartTarget() {
        // Ch·ªçn m·ªôt ƒëi·ªÉm ng·∫´u nhi√™n tr√™n ƒë∆∞·ªùng cong tr√°i tim
        const t = Math.random() * Math.PI * 2;
        const point = getHeartPoint(t);
        
        // CƒÉn gi·ªØa m√†n h√¨nh v√† scale
        // Th√™m ch√∫t ng·∫´u nhi√™n (random) ƒë·ªÉ tim tr√¥ng ƒë·∫ßy ƒë·∫∑n h∆°n, kh√¥ng ch·ªâ l√† ƒë∆∞·ªùng vi·ªÅn
        const shrink = Math.random() < 0.3 ? (Math.random() * 0.8) : 1; // 30% h·∫°t n·∫±m b√™n trong tim
        
        this.targetX = width / 2 + (point.x * heartScale * shrink);
        this.targetY = height / 2 + (point.y * heartScale * shrink) - (heartScale * 2); // D·ªãch l√™n t√≠ cho c√¢n
    }

    update() {
        if (isHeartFormed && this.targetX !== null) {
            // DI CHUY·ªÇN V·ªÄ H√åNH TR√ÅI TIM
            const dx = this.targetX - this.x;
            const dy = this.targetY - this.y;
            
            this.x += dx * this.friction;
            this.y += dy * this.friction;
            
            // Hi·ªáu ·ª©ng rung nh·∫π khi ƒë√£ ƒë·ª©ng y√™n
            this.x += (Math.random() - 0.5) * 0.5;
            this.y += (Math.random() - 0.5) * 0.5;
        } else {
            // DI CHUY·ªÇN T·ª∞ DO (L√∫c ch∆∞a b·∫•m n√∫t ho·∫∑c background)
            this.x += this.vx;
            this.y += this.vy;

            // D·ªôi t∆∞·ªùng
            if (this.x < 0 || this.x > width) this.vx *= -1;
            if (this.y < 0 || this.y > height) this.vy *= -1;
        }
    }

    draw() {
        ctx.globalAlpha = this.opacity;
        ctx.fillStyle = this.color;
        
        // V·∫Ω h√¨nh tr√°i tim nh·ªè thay v√¨ h√¨nh tr√≤n
        ctx.beginPath();
        // M·ªôt c√°ch v·∫Ω tim ƒë∆°n gi·∫£n tr√™n canvas
        let s = this.size;
        ctx.moveTo(this.x, this.y);
        ctx.bezierCurveTo(this.x - s, this.y - s, this.x - 2*s, this.y + s/2, this.x, this.y + 2*s);
        ctx.bezierCurveTo(this.x + 2*s, this.y + s/2, this.x + s, this.y - s, this.x, this.y);
        ctx.fill();
        ctx.globalAlpha = 1;
    }
}

// --- CLASS FLOWER (C√°nh hoa r∆°i) ---
class Flower {
    constructor() {
        this.reset();
    }
    
    reset() {
        this.x = Math.random() * width;
        this.y = -10; // B·∫Øt ƒë·∫ßu t·ª´ tr√™n n√≥c
        this.size = Math.random() * 5 + 3;
        this.speed = Math.random() * 1.5 + 0.5;
        this.angle = Math.random() * 360;
        this.spin = (Math.random() - 0.5) * 0.1;
        this.type = Math.random() > 0.5 ? 'peach' : 'apricot'; // ƒê√†o ho·∫∑c Mai
    }

    update() {
        this.y += this.speed;
        this.x += Math.sin(this.y * 0.01); // L·∫Øc l∆∞
        this.angle += this.spin;

        if (this.y > height) {
            this.reset();
        }
    }

    draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.angle);
        
        if (this.type === 'peach') {
            ctx.fillStyle = "#ffb7b2"; // H·ªìng ph·∫•n
        } else {
            ctx.fillStyle = "#ffeb3b"; // V√†ng mai
        }
        
        // V·∫Ω c√°nh hoa ƒë∆°n gi·∫£n (h√¨nh elip)
        ctx.beginPath();
        ctx.ellipse(0, 0, this.size, this.size / 2, 0, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.restore();
    }
}

// --- KH·ªûI T·∫†O ---
function init() {
    for (let i = 0; i < PARTICLE_COUNT; i++) {
        particles.push(new Particle());
    }
    for (let i = 0; i < FLOWER_COUNT; i++) {
        flowers.push(new Flower());
    }
}

// --- V√íNG L·∫∂P ANIMATION ---
function animate() {
    ctx.clearRect(0, 0, width, height); // X√≥a m√†n h√¨nh c≈©

    // 1. V·∫Ω hoa r∆°i (n·ªÅn)
    flowers.forEach(flower => {
        flower.update();
        flower.draw();
    });

    // 2. V·∫Ω c√°c h·∫°t tim
    particles.forEach(p => {
        p.update();
        p.draw();
    });

    requestAnimationFrame(animate);
}

// --- X·ª¨ L√ù S·ª∞ KI·ªÜN ---
function startShow() {
    // 1. ·∫®n n√∫t
    document.getElementById('startBtn').style.display = 'none';
    
    // 2. K√≠ch ho·∫°t ch·∫ø ƒë·ªô x·∫øp h√¨nh tim
    isHeartFormed = true;
    particles.forEach(p => p.setHeartTarget());

    // 3. Hi·ªÉn th·ªã text sau 1.5 gi√¢y (ƒë·ª£i tim x·∫øp xong)
    setTimeout(() => {
        document.getElementById('msgBox').classList.add('visible');
        document.getElementById('coupLeft').classList.add('visible');
        setTimeout(() => {
            document.getElementById('coupRight').classList.add('visible');
        }, 800); // C√¢u ƒë·ªëi ph·∫£i hi·ªán sau c√¢u ƒë·ªëi tr√°i 1 x√≠u
    }, 1500);
}

// Ch·∫°y th√¥i
init();
animate();

</script>
</body>
</html>
